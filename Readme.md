                                                                  Хакатон(кейс VK)
Здесь вы можете найти решение задачи команды VARCUBIKS для Хакатона по кейсу вк.
Решение задачи по прогнозированию значения переменной x на основе данных train.csv и test.csv с помощью модели XGBoost.
________________________________________________________________________________________________________________________________________
![image](https://github.com/LAITxNIKEYs/hsksvk/assets/104034823/bc83c545-1d4e-4bcc-89af-1c940280f485)
________________________________________________________________________________________________________________________________________


Использование библиотек XGBoost, pandas, numpy. 

________________________________________________________________________________________________________________________________________
![image](https://github.com/LAITxNIKEYs/hsksvk/assets/104034823/a521bcc7-1508-4ccc-a49b-212a28b59782)
________________________________________________________________________________________________________________________________________


Как мы решали задачу:

Преобразование переменной x в логарифм, обработка числовых признаков, удаление ненужных признаков, обучение модели XGBoost с определенными параметрами и сохранение результатов в файл submission.csv. 

Уникальность решения заключается в использовании XGBoost для прогнозирования значений переменной x и преобразовании переменной x в логарифм для улучшения качества модели.

________________________________________________________________________________________________________________________________________
![image](https://github.com/LAITxNIKEYs/hsksvk/assets/104034823/93ebccbd-5c69-43f8-878a-2ec34dcccb43)
________________________________________________________________________________________________________________________________________


В репозитории находятся два решения, которые на наш взгляд обсалютно верны, но проверить их нашей команде не удалось, так как наше оборудование не позволило нам этого сделать. Ниже представлен скрин ошибки, которая возникла у нас при решение задачи:

________________________________________________________________________________________________________________________________________
![image](https://github.com/LAITxNIKEYs/hsksvk/assets/104034823/0866e3fa-f51e-4dfe-8ef2-78b05d179eb7)
________________________________________________________________________________________________________________________________________

Оба решения затратны по памяти и если бы было больше времени, то мы бы сумели оптимизировать его так, чтобы возможно было получить файл csv с верным ответом.


Решения задачи являются индивидуальным, каждый из участников команды участвовал в создание. В первом файле под названием haks представлено самое первое и совместное решение от нашей команды, а второе решение в файле gg уже собрано из 4 разных кодов, которые составляли участники команды.



 ________________________________________________________________________________________________________________________________________
 
                                               Зачем наш код нужен?
                                                         
 ________________________________________________________________________________________________________________________________________
 
Наш код предназначен для обучения модели машинного обучения на данных из файлов train.csv, test.csv и attr.csv, а также для создания прогнозов на тестовых данных и сохранения их в файл submission.csv. 
Сначала происходит импорт необходимых библиотек: pandas, numpy и XGBRegressor из библиотеки xgboost. 

 ________________________________________________________________________________________________________________________________________
 
Затем загружаются данные из файлов для анализа. В train_df и test_df сохраняются данные из файлов train.csv и test.csv соответственно, а в attr_df сохраняются данные из файла attr.csv. 

________________________________________________________________________________________________________________________________________
 
Далее происходит объединение данных из train_df и attr_df по столбцам ego_id и u, а также данных из test_df и attr_df по тем же столбцам.

________________________________________________________________________________________________________________________________________

Затем пропущенные значения в столбцах city_id, sex, school и university заполняются значением -1, а затем эти столбцы преобразуются в тип int8. 
Далее целевая переменная x1 преобразуется логарифмически. 

________________________________________________________________________________________________________________________________________

Затем определяются признаки (X_train) и целевая переменная (y_train) на основе данных из train_df, а также признаки на основе данных из test_df (X_test). 

________________________________________________________________________________________________________________________________________

После этого модель XGBRegressor обучается на данных из X_train и y_train с использованием параметров max_depth=4, objective='reg:squarederror' и n_estimators=1000. 
Затем модель используется для создания прогнозов на данных из X_test, которые обратно преобразуются из логарифмической формы в исходную форму. 

________________________________________________________________________________________________________________________________________

Наконец, создаются данные для файла submission.csv на основе данных из test_df и сохраняются в файл submission.csv.

________________________________________________________________________________________________________________________________________

Финальное решение:

<picture> import pandas as pd
import numpy as np
from xgboost import XGBRegressor


train_df = pd.read_csv("train.csv", dtype={'city_id': 'int8', 'sex': 'int8', 'school': 'int16', 'university': 'int16'})
test_df = pd.read_csv("test.csv", dtype={'city_id': 'int8', 'sex': 'int8', 'school': 'int16', 'university': 'int16'})

attr_df = pd.read_csv('attr.csv', dtype={'ego_id': 'int32', 'u': 'int32'})
train_df = pd.merge(train_df, attr_df, on=['ego_id','u'], how='left')
test_df = pd.merge(test_df, attr_df, on=['ego_id','u'], how='left')


train_df[['city_id','sex','school','university']] = train_df[['city_id','sex','school','university']].fillna(-1).astype('int8')
test_df[['city_id','sex','school','university']] = test_df[['city_id','sex','school','university']].fillna(-1).astype('int8')

# Преобразуем целевую переменную логарифмически
train_df['x1'] = np.log(train_df['x1'])

# Выделяем признаки и целевую переменную
X_train = train_df[['v','t','x2','x3','age','city_id','school','university']]
y_train = train_df['x1']
X_test = test_df[['v','t','x2','x3','age','city_id','school','university']]

# Обучаем модель
model = XGBRegressor(max_depth=4, objective='reg:squarederror', n_estimators=1000)
model.fit(X_train, y_train)

# Получаем прогнозы и обратно преобразуем целевую переменную
predictions = np.exp(model.predict(X_test))

# Сохраняем прогнозы в файл
submission = test_df[['ego_id', 'u', 'v']].copy()
submission['x1'] = predictions
submission.sort_values(['ego_id', 'u', 'v']).to_csv('submission.csv', index=False)
print("Готово!")






                                              Связь с нами и участники команды:
                                              
________________________________________________________________________________________________________________________________________
![image](https://github.com/LAITxNIKEYs/hsksvk/assets/104034823/a9e77979-1b96-4b97-9c51-2d7056d2a1a3)
________________________________________________________________________________________________________________________________________

                                                        Наши работяги:
 ________________________________________________________________________________________________________________________________________
 ________________________________________________________________________________________________________________________________________
                                                       А кто это у нас?

________________________________________________________________________________________________________________________________________
![image](https://github.com/LAITxNIKEYs/hsksvk/assets/104034823/a46dc3b8-aeec-4ef1-a044-648804e67251)
________________________________________________________________________________________________________________________________________

                                                       Опа, а еще кто?
________________________________________________________________________________________________________________________________________ 
![image](https://github.com/LAITxNIKEYs/hsksvk/assets/104034823/50d4259f-cd05-40e8-b0f2-560d21b56983)
________________________________________________________________________________________________________________________________________


